@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix cv: <http://data.europa.eu/m8g/> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix org: <http://www.w3.org/ns/org#> .
@prefix rov: <https://www.w3.org/TR/vocab-regorg> .
@prefix schema: <http://schema.org/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix be-dataentry: <http://vocab.belgif.be/ns/dataentry#> .
@prefix be-gdpr: <http://vocab.belgif.be/ns/gdpr#> .
@prefix be-infosec: <http://vocab.belgif.be/ns/infosec#> .
@prefix shbe-gdpr: <http://vocab.belgif.be/shacl/gdpr#> .

<http://vocab.belgif.be/shacl/gdpr#> a owl:Ontology ;
	owl:versionInfo "Draft 2018-05-14" ;
	rdfs:label "GDPR model"@nl, "GDPR model"@fr, "GDPR model"@de, "GDPR model"@en ;
	rdfs:comment "GDPR SHACL rules"@en, "GDPR SHACL rules"@fr, "GDPR SHACL rules"@nl, "GDPR SHACL rules"@de .

shbe-gdpr:RegisterShape a sh:NodeShape ;
	sh:targetClass be-gdpr:Register ;
	sh:property [
		sh:path dcterms:title ;
		sh:minCount 1 ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path dcterms:rightsHolder ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class org:Organization ;
	] ;
	sh:property [
		sh:path be-gdpr:hasDataTreatment ;
		sh:nodeKind sh:IRI ;
		sh:class be-gdpr:DataTreatment ;
	] ;
	sh:property [
		sh:path dcterms:accessRights ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://publications.europa.eu/resource/authority/access-rights> ;
			] ;
		] ;
	] .

shbe-gdpr:OrganizationShape a sh:NodeShape ;
	sh:targetClass org:Organization ;
	sh:property [
		sh:path skos:altLabel ;
		sh:datatype rdfs:Literal ;
		sh:minCount 1 ;
	] ;
	sh:property [
		sh:path skos:notation ;
		sh:datatype xsd:string ;
		sh:maxCount 1 ;
	] .
	

shbe-gdpr:DataTreatmentPartShape a sh:NodeShape ;
	sh:targetClass be-gdpr:DataTreatmentPart ;
	sh:property [
		sh:path be-gdpr:conservation ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:dataCategory ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://vocab.belgif.be/auth/gdpr-category#id> ;
			] ;
		] ;
	] ;
	sh:property [
		sh:path be-gdpr:dataCategoryText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:isJuridical ;
		sh:datatype xsd:boolean ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
	] ;
	sh:property [
		sh:path be-gdpr:hasDataReceiver ;
		sh:nodeKind sh:IRI ;
		sh:class be-gdpr:DataReceiver ;
	] .

shbe-gdpr:ControllerShape a sh:NodeShape ;
	sh:targetClass be-gdpr:Controller ;
	sh:property [
		sh:path org:memberOf ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class org:Organization ;
	] ;
	sh:property [
		sh:path be-gdpr:hasResponsible ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class schema:ContactPoint ;
	] ;
	sh:property [
		sh:path be-gdpr:hasDelegate ;
		sh:maxCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class schema:ContactPoint ;
	] ;
	sh:property [
		sh:path be-gdpr:hasDPO ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class schema:ContactPoint ;
	] ;
	sh:property [
		sh:path be-gdpr:isDPOInternal ;
		sh:datatype xsd:boolean ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
	] ;
	sh:property [
		sh:path be-gdpr:isDPOInternalText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:emailPrivacyQuestions ;
		sh:datatype xsd:string ;
		sh:maxCount 1 ;
	] .

shbe-gdpr:ProcessorShape a sh:NodeShape ;
	sh:targetClass be-gdpr:Processor ;
	sh:property [
		sh:path be-gdpr:contract ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;		
	sh:property [
		sh:path org:memberOf ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class org:Organization ;
	] ;
	sh:property [
		sh:path be-gdpr:hasResponsible ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class schema:ContactPoint ;
	] ;
	sh:property [
		sh:path be-gdpr:hasDelegate ;
		sh:maxCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class schema:ContactPoint ;
	] ;
	sh:property [
		sh:path be-gdpr:hasDPO ;
		sh:maxCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class schema:ContactPoint ;
	] .

shbe-gdpr:DataReceiverGenericShape a sh:NodeShape ;
	sh:targetClass be-gdpr:DataReceiverGeneric ;
	sh:property [
		sh:path be-gdpr:guarantee ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:receiverType ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://vocab.belgif.be/auth/gdpr-recvgen#id> ;
			] ;
		] ;
	] ;
	sh:property [
		sh:path be-gdpr:receiverTypeText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] .

shbe-gdpr:DataReceiverSpecificShape a sh:NodeShape ;
	sh:targetClass be-gdpr:DataReceiverSpecific ;
	sh:property [
		sh:path be-gdpr:guarantee ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:receiverType ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://vocab.belgif.be/auth/gdpr-recvspec#id> ;
			] ;
		] ;
	] ;
	sh:property [
		sh:path be-gdpr:receiverTypeText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:transferNature ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://vocab.belgif.be/auth/gdpr-transfer#id> ;
			] ;
		] ;
	] ;
	sh:property [
		sh:path be-gdpr:transferNatureText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path org:memberOf ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class org:Organization ;
	] ;
	sh:property [
		sh:path cv:hasContactPoint ;
		sh:minCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class schema:ContactPoint ;
	] ;
	sh:property [
		sh:path be-gdpr:destinationCountry ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://publications.europa.eu/resource/authority/country> ;
			] ;
		] ;
	] .

shbe-gdpr:DataTreatmentShape a sh:NodeShape ;
	sh:targetClass be-gdpr:DataTreatment ;
	sh:property [
		sh:path dcterms:identifier ;
		sh:maxCount 1 ;
		sh:datatype rdfs:Literal ;
	] ;
	sh:property [
		sh:path dcterms:title ;
		sh:datatype rdf:langString ;
		sh:minCount 1 ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:classificationLevel ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path dcterms:description ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path dcterms:hasPart ;
		sh:minCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class be-gdpr:DataTreatmentPart ;
	] ;
	sh:property [
		sh:path be-gdpr:hasController ;
		sh:minCount 1 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class be-gdpr:Controller ;
	] ;
	sh:property [
		sh:path be-gdpr:hasProcessor ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class be-gdpr:Processor ;
	] ;
	sh:property [
		sh:path be-gdpr:treatmentType ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://vocab.belgif.be/auth/gdpr-treatment#id> ;
			];
		] ;
	] ;
	sh:property [
		sh:path be-gdpr:treatmentTypeText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-dataentry:hasDataStatus ;
		sh:minCount 4 ;
		sh:nodeKind sh:BlankNodeOrIRI ;
		sh:class be-dataentry:DataStatus ;
	] ;	
	sh:property [
		sh:path be-gdpr:authoritativeSource ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:otherSource ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:authorization ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:businessProcess ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:businessProcessOwner ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path schema:startDate ;
		sh:datatype xsd:date ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:lessThanOrEquals schema:endDate ;
	] ;	
	sh:property [
		sh:path schema:endDate ;
		sh:datatype xsd:date ;
		sh:maxCount 1 ;
	] ;	
	sh:property [
		sh:path be-gdpr:dataCoupling ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:finalityMain ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://vocab.belgif.be/auth/gdpr-finality#id> ;
			] ;
		] ;
	] ;
	sh:property [
		sh:path be-gdpr:finalityOther ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://vocab.belgif.be/auth/gdpr-finality#id> ;
			] ;
		] ;
	] ;
	sh:property [
		sh:path be-gdpr:finalityText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path dcterms:accessRights ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://publications.europa.eu/resource/authority/access-rights> ;
			] ;
		] ;
	] ;
	sh:property [
		sh:path be-gdpr:involvedParty ;
		sh:minCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://vocab.belgif.be/auth/gdpr-involved#id> ;
			] ;
		] ;
	] ;
	sh:property [
		sh:path be-gdpr:involvedPartyInformation ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:involvedPartyText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:juridicalBase ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://vocab.belgif.be/auth/gdpr-juridical#id> ;
			] ;
		] ;
	] ;
	sh:property [
		sh:path be-gdpr:juridicalBaseText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:privacyImpact ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:policy ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:isVulnerable ;
		sh:datatype xsd:boolean ;
		sh:maxCount 1;
	] ;
	sh:property [
		sh:path be-gdpr:isVulnerableText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-infosec:availability ;
		sh:datatype xsd:nonNegativeInteger ;
		sh:maxCount 1 ;
		sh:minInclusive 0 ;
		sh:maxInclusive 5 ;
	] ;
	sh:property [
		sh:path be-infosec:confidentiality ;
		sh:datatype xsd:nonNegativeInteger ;
		sh:maxCount 1 ;
		sh:minInclusive 0 ;
		sh:maxInclusive 5 ;
	] ;
	sh:property [
		sh:path be-infosec:integrity ;
		sh:datatype xsd:nonNegativeInteger ;
		sh:maxCount 1 ;
		sh:minInclusive 0 ;
		sh:maxInclusive 5 ;
	] ;
	sh:property [
		sh:path be-infosec:nonrepudiation ;
		sh:datatype xsd:nonNegativeInteger ;
		sh:maxCount 1 ;
		sh:minInclusive 0 ;
		sh:maxInclusive 5 ;
	] ;
	sh:property [
		sh:path be-gdpr:remarks ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:rightsProcedure ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:securityMeasure ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://vocab.belgif.be/auth/securitymeasure#id> ;
			] ;
		] ;
	] ;
	sh:property [
		sh:path be-gdpr:securityMeasuresText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:securityMeasuresDoc ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:replacedBy ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:technology ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:technologyRisks ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true ;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] ;
	sh:property [
		sh:path be-gdpr:isSensitive ;
		sh:datatype xsd:boolean ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
	] ;
	sh:property [
		sh:path be-gdpr:isSensitiveText ;
		sh:datatype rdf:langString ;
		sh:uniqueLang true;
		sh:languageIn ("nl" "fr" "de" "en") ;
	] .
	
shbe-gdpr:DataStatusShape a sh:NodeShape ;
	sh:targetClass be-dataentry:DataStatus ;
	sh:property [
		sh:path dcterms:language ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:nodeKind sh:IRI ;
		sh:class skos:Concept ;
		sh:node [
			a sh:NodeShape ;
			sh:property [
				sh:path skos:inScheme ;
				sh:hasValue <http://publications.europa.eu/resource/authority/language> ;
			] ;
		] ;
	] ;
	sh:property [
		sh:path be-dataentry:importStatus ;
		sh:nodeKind sh:IRI ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:class skos:Concept ;
	] ;
	sh:property [
		sh:path be-dataentry:exportStatus ;
		sh:nodeKind sh:IRI ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
		sh:class skos:Concept ;
	] .

shbe-gdpr:ContactShape a sh:NodeShape ;
	sh:targetClass schema:ContactPoint ;
	sh:property [
		sh:path schema:name ;
		sh:datatype xsd:string ;
	] ;
	sh:property [
		sh:path schema:email ;
		sh:datatype xsd:string ;
	] ;
	sh:property [
		sh:path schema:faxNumber ;
		sh:datatype xsd:string ;
	] ;
	sh:property [
		sh:path schema:telephone ;
		sh:datatype xsd:string ;
	] .